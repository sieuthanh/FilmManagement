/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * EditAdmin.java
 *
 * Created on Oct 27, 2011, 9:25:14 PM
 */
package admin.view;

import java.awt.Image;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.text.JTextComponent;

import databasemanager.Person;

import admin.controller.PersonController;

/**
 *
 * @author CodeBlue
 */
public class EditPerson extends javax.swing.JDialog {

    private String selectedID;

    /** Creates new form EditAdmin */
    public EditPerson(String selectedID) {
        super();
        initComponents();
        Image icon = getToolkit().getImage(getClass().getResource("/images/app_icon_32.png"));
        setIconImage(icon);
        setLocationRelativeTo(null);
        setVisible(true);
        this.selectedID = selectedID;
        fillFields();
    }

    // fill fields on dialog
    private void fillFields() {
    	SimpleDateFormat mySimpleDateFormat = new SimpleDateFormat("dd/mm/yyyy");
        Person person = PersonController.getPerson(selectedID);
        Date date = new Date();
        System.out.println(person.getDay());
        String[] arrstr = person.getDay().split("-");
        int day = Integer.parseInt(arrstr[0]);
        int month = Integer.parseInt(arrstr[1]);
        int year = Integer.parseInt(person.getYear());
        day = date.getDay();
        month = date.getMonth();
        year = date.getYear();
        txtId.setText(person.getId());
        txtPName.setText(person.getName());
        txtBorn.setText(person.getBorn());
        if (person.getSex()=="Male") {
            radMale.setSelected(true);
        } else {
            radFemale.setSelected(true);
        }
        if(person.getIsdirector().equals("1")){
        	isDirector.setSelected(true);
        }else {
        	isDirector.setSelected(false);
        }
        if(person.getIsstar().equals("1")){
        	isStar.setSelected(true);
        }else {
        	isStar.setSelected(false);
        }
			jxDate.setDate(date);
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

buttonGroup1 = new javax.swing.ButtonGroup();
        
        jPanel1 = new javax.swing.JPanel();
        
        jLabelName = new javax.swing.JLabel();
        jLabelGender = new javax.swing.JLabel();
        jLabelBirthday = new javax.swing.JLabel();
        jLabelStar = new javax.swing.JLabel();
        jLabelDirector = new javax.swing.JLabel();
        jLabelBorn = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        jLabelId = new javax.swing.JLabel();
        jLabelJob = new javax.swing.JLabel();
        
        txtDirector = new javax.swing.JTextField();
        txtBorn = new javax.swing.JTextField();
        txtPName = new javax.swing.JTextField();
        txtId = new javax.swing.JTextField();
        txtStar = new javax.swing.JTextField();
        
        radMale = new javax.swing.JRadioButton();
        radFemale = new javax.swing.JRadioButton();
        
        isStar = new javax.swing.JCheckBox();
        isDirector = new javax.swing.JCheckBox();
        
        jxDate = new org.jdesktop.swingx.JXDatePicker();

        btnUpdate = new javax.swing.JButton();
        btnExit = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Update Person");

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jLabelName.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelName.setForeground(new java.awt.Color(51, 51, 51));
        jLabelName.setText("Name");

        jLabelGender.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelGender.setForeground(new java.awt.Color(51, 51, 51));
        jLabelGender.setText("Gender");

        jLabelBirthday.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelBirthday.setForeground(new java.awt.Color(51, 51, 51));
        jLabelBirthday.setText("Birthday");

        jLabelStar.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelStar.setForeground(new java.awt.Color(51, 51, 51));
        jLabelStar.setText("Star");

        jLabelDirector.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelDirector.setForeground(new java.awt.Color(51, 51, 51));
        jLabelDirector.setText("Director");

        jLabelBorn.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelBorn.setForeground(new java.awt.Color(51, 51, 51));
        jLabelBorn.setText("Born");
        
        jLabelJob.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelJob.setForeground(new java.awt.Color(51, 51, 51));
        jLabelJob.setText("Job");

        txtDirector.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        radMale.setBackground(new java.awt.Color(255, 255, 255));
        buttonGroup1.add(radMale);
        radMale.setSelected(true);
        radMale.setText("Male");

        radFemale.setBackground(new java.awt.Color(255, 255, 255));
        buttonGroup1.add(radFemale);
        radFemale.setText("Female");
        
        isStar.setBackground(new java.awt.Color(255, 255, 255));
        isStar.setText("Star");
        isStar.setFocusable(false);

        isDirector.setBackground(new java.awt.Color(255, 255, 255));
        isDirector.setText("Director");
        isDirector.setFocusable(false);

        txtBorn.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txtPName.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        txtId.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel8.setForeground(new java.awt.Color(0, 102, 153));
        jLabel8.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel8.setText("Update Person");

        btnUpdate.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/update.png"))); // NOI18N
        btnUpdate.setText("Update");
        btnUpdate.setMargin(new java.awt.Insets(2, 10, 2, 10));
        btnUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateActionPerformed(evt);
            }
        });

        btnExit.setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/exit.png"))); // NOI18N
        btnExit.setText("Exit");
        btnExit.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExitActionPerformed(evt);
            }
        });

        jLabelId.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N
        jLabelId.setForeground(new java.awt.Color(51, 51, 51));
        jLabelId.setText("Id");

        txtStar.setFont(new java.awt.Font("Tahoma", 0, 12)); // NOI18N


        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 367, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap(27, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabelId)
                    .addComponent(jLabelName)
                    .addComponent(jLabelGender)
                    .addComponent(jLabelBirthday)
                    .addComponent(jLabelJob)
                    .addComponent(jLabelBorn))
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
               			.addComponent(isStar)
               			.addComponent(isDirector))
               		.addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(radMale)
                        .addComponent(radFemale))
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addComponent(txtId)
                        .addComponent(txtPName, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jxDate, javax.swing.GroupLayout.PREFERRED_SIZE, 175, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtBorn, javax.swing.GroupLayout.PREFERRED_SIZE, 158, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(26, 26, 26))
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(72, 72, 72)
                .addComponent(btnUpdate)
                .addGap(74, 74, 74)
                .addComponent(btnExit)
                .addContainerGap(75, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel1Layout.createSequentialGroup()
                    .addGap(11, 11, 11)
                    .addComponent(jLabel8)
                    .addGap(27, 27, 27)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabelId)
                        .addComponent(txtId, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabelName)
                        .addComponent(txtPName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(radMale)
                            .addComponent(jLabelGender))
                        .addComponent(radFemale))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jxDate, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabelBirthday))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    		.addComponent(jLabelJob)
                    		.addComponent(isStar)
                    		.addComponent(isDirector))
                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtBorn, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabelBorn))
                    .addGap(18, 18, 18)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(btnUpdate)
                        .addComponent(btnExit))
                    .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            );

            javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
            getContentPane().setLayout(layout);
            layout.setHorizontalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            );
            layout.setVerticalGroup(
                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
            );

            pack();
    }// </editor-fold>//GEN-END:initComponents

    //<editor-fold defaultstate="collapsed" desc="events on buttons">
    private void btnExitActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExitActionPerformed
        // TODO add your handling code here:
        dispose();
    }//GEN-LAST:event_btnExitActionPerformed

    // update a manager's profile
    private void btnUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateActionPerformed
        // TODO add your handling code here:
        JTextComponent[] tcp = {txtId, txtPName, txtBorn};
        if (!Validator.validateComponents(tcp)) {
            return;
        }
        String id = txtId.getText();
        String name = txtPName.getText();
        String born = txtBorn.getText();
        String gender = "Male";
        boolean male = true;
        if (radFemale.isSelected()) {
            male = false;
            gender = "Female";
        }
        String star = "0";
        if (isStar.isSelected()) {
            star = "1";
        }
        String director = "0";
        if (isDirector.isSelected()) {
            director = "1";
        }
        String day = String.valueOf(jxDate.getDate().getDay());
        String month = String.valueOf(jxDate.getDate().getMonth()+1);
        String year = String.valueOf(jxDate.getDate().getYear()+1900);
        String day1 = day+"-"+month;
        if (PersonController.update(selectedID, name, gender, day1, year, born, director, star)) {
            new CustomMessageDialog(null, true, "Done!", "Updated sucessfully!", CustomMessageDialog.DONE);
            AdminPersonList.reloadTable();
        }
    }//GEN-LAST:event_btnUpdateActionPerformed
    //</editor-fold>
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnExit;
    private javax.swing.JButton btnUpdate;
    
    private javax.swing.ButtonGroup buttonGroup1;
    
    private javax.swing.JLabel jLabelName;
    private javax.swing.JLabel jLabelGender;
    private javax.swing.JLabel jLabelBirthday;
    private javax.swing.JLabel jLabelStar;
    private javax.swing.JLabel jLabelDirector;
    private javax.swing.JLabel jLabelBorn;
    private javax.swing.JLabel jLabelId;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabelJob;
    
    private javax.swing.JPanel jPanel1;
    
    private org.jdesktop.swingx.JXDatePicker jxDate;
    
    private javax.swing.JRadioButton radFemale;
    private javax.swing.JRadioButton radMale;
    
    private javax.swing.JCheckBox isStar;
    private javax.swing.JCheckBox isDirector;
    
    private javax.swing.JTextField txtId;
    private javax.swing.JTextField txtPName;
    private javax.swing.JTextField txtDirector;
    private javax.swing.JTextField txtBorn;
    private javax.swing.JTextField txtStar;
    // End of variables declaration//GEN-END:variables
}
